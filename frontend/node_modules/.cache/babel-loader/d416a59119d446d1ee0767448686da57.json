{"ast":null,"code":"import _regeneratorRuntime from\"/Users/aroyehunoluwasegun/Downloads/proxy-storeIssue/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/aroyehunoluwasegun/Downloads/proxy-storeIssue/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";var getState=function getState(_ref){var getStore=_ref.getStore,getActions=_ref.getActions,setStore=_ref.setStore;return{store:{token:null,message:null,demo:[{title:\"First Task\",done:false},{title:\"Second Task\",done:false}]},actions:{// Use getActions to call a function within a function\nexampleFunction:function exampleFunction(){getActions().changeColor(0,\"green\");},syncTokenFromSessionStore:function syncTokenFromSessionStore(){var token=sessionStorage.getItem('token');console.log(\"application just loaded synching the local storage token with the session storage token\");if(token&&token!=\"\"&&token!=\"undefined\")setStore({token:token});},//logout function and redirect to home page onclick\nlogout:function logout(){sessionStorage.removeItem('token');setStore({token:null});console.log('loggging you out');window.location.href=\"/\";},login:function(){var _login=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(email,password){var opts,resp,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// THIS WAS USED TO TEST FOR LOGIN TRY IT AND CHECK YOUR CONSOLE\nconsole.log(\"I want to login oooo\");console.log(email);console.log(password);// THIS WAS USED TO TEST FOR LOGIN TRY IT AND CHECK YOUR CONSOLE\nopts={method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email:email,password:password})};_context.prev=4;_context.next=7;return fetch('/token',opts);case 7:resp=_context.sent;if(!(resp.status!==200)){_context.next=11;break;}alert('Invalid credentials');return _context.abrupt(\"return\",false);case 11:_context.next=13;return resp.json();case 13:data=_context.sent;console.log('this came from backend',data);sessionStorage.setItem('token',data.access_token);setStore({token:data.access_token});return _context.abrupt(\"return\",true);case 20:_context.prev=20;_context.t0=_context[\"catch\"](4);console.error(\"there was an error login in!!!\",_context.t0);case 23:case\"end\":return _context.stop();}}},_callee,null,[[4,20]]);}));function login(_x,_x2){return _login.apply(this,arguments);}return login;}(),loadSomeData:function loadSomeData(){var store=getStore();var opts={headers:{'Authorization':'Bearer '+store.token}};// fetching data from the backend\nfetch(\"http://localhost:5000/\",opts).then(function(resp){return resp.json();}).then(function(data){return setStore({message:data.message});}).catch(function(error){return console.log(\"Error loading data\",error);});},changeColor:function changeColor(index,color){//get the store\nvar store=getStore();//we have to loop the entire demo array to look for the respective index\n//and change its color\nvar demo=store.demo.map(function(elm,i){if(i===index)elm.background=color;return elm;});//reset the global store\nsetStore({demo:demo});}}};};export default getState;","map":{"version":3,"names":["getState","getStore","getActions","setStore","store","token","message","demo","title","done","actions","exampleFunction","changeColor","syncTokenFromSessionStore","sessionStorage","getItem","console","log","logout","removeItem","window","location","href","login","email","password","opts","method","headers","body","JSON","stringify","fetch","resp","status","alert","json","data","setItem","access_token","error","loadSomeData","then","catch","index","color","map","elm","i","background"],"sources":["/Users/aroyehunoluwasegun/Downloads/proxy-storeIssue/frontend/src/Components/store/actions/actions.js"],"sourcesContent":["const getState = ({getStore, getActions, setStore}) => {\n    \n    return {\n        \n        store: {\n            token: null,\n            message: null,\n            demo: [ \n                { \n                    title: \"First Task\", \n                    done: false \n                }, \n                { \n                    title: \"Second Task\", \n                    done: false \n                } \n            ],\n         \n        },\n        \n        actions: {\n            // Use getActions to call a function within a function\n            exampleFunction: () => {\n                getActions().changeColor(0, \"green\");\n            },\n\n            syncTokenFromSessionStore: () => {\n                const token = sessionStorage.getItem('token');\n                console.log(\"application just loaded synching the local storage token with the session storage token\")\n                if (token && token != \"\" && token != \"undefined\") setStore({token: token});\n            },\n\n            //logout function and redirect to home page onclick\n\n            logout: () => {\n                sessionStorage.removeItem('token');\n                setStore({token: null});\n                console.log('loggging you out')\n                window.location.href = \"/\";\n            },\n\n            login: async (email, password) => {\n                // THIS WAS USED TO TEST FOR LOGIN TRY IT AND CHECK YOUR CONSOLE\n                console.log(\"I want to login oooo\")\n                console.log(email)\n                console.log(password)\n                // THIS WAS USED TO TEST FOR LOGIN TRY IT AND CHECK YOUR CONSOLE\n                const opts = {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify({\n                        email: email,\n                        password: password,\n                    }),\n                };\n\n                try {\n                    const resp = await fetch('/token', opts)\n                    if (resp.status !== 200) {\n                        alert('Invalid credentials');\n                        return false;\n                    }\n\n                    const data = await resp.json();\n                    console.log('this came from backend',data );\n                    sessionStorage.setItem('token', data.access_token);\n                    setStore({token: data.access_token});\n                    return true;\n                }\n                catch (error) {\n                    console.error(\"there was an error login in!!!\", error);\n                }\n               \n            },\n\n            loadSomeData: () => {\n                const store = getStore();\n                const opts = {\n                    headers: {\n                        'Authorization': 'Bearer ' + store.token,\n                    },\n                };\n                // fetching data from the backend\n                fetch(\"http://localhost:5000/\", opts)\n                    .then(resp => resp.json())\n                    .then(data => setStore({message: data.message}))\n                    .catch(error => console.log(\"Error loading data\", error));\n            },\n            changeColor: (index, color) => {\n                //get the store\n                const store = getStore();\n\n                //we have to loop the entire demo array to look for the respective index\n                //and change its color\n                const demo = store.demo.map((elm, i) => {\n                    if (i === index) elm.background = color;\n                    return elm;\n                });\n                \n\n                //reset the global store\n                setStore({ demo: demo });\n            },\n\n           \n            \n        }\n    };\n};\n\n\nexport default getState;\n"],"mappings":"sTAAA,GAAMA,SAAQ,CAAG,QAAXA,SAAW,MAAsC,IAApCC,SAAoC,MAApCA,QAAoC,CAA1BC,UAA0B,MAA1BA,UAA0B,CAAdC,QAAc,MAAdA,QAAc,CAEnD,MAAO,CAEHC,KAAK,CAAE,CACHC,KAAK,CAAE,IADJ,CAEHC,OAAO,CAAE,IAFN,CAGHC,IAAI,CAAE,CACF,CACIC,KAAK,CAAE,YADX,CAEIC,IAAI,CAAE,KAFV,CADE,CAKF,CACID,KAAK,CAAE,aADX,CAEIC,IAAI,CAAE,KAFV,CALE,CAHH,CAFJ,CAkBHC,OAAO,CAAE,CACL;AACAC,eAAe,CAAE,0BAAM,CACnBT,UAAU,GAAGU,WAAb,CAAyB,CAAzB,CAA4B,OAA5B,EACH,CAJI,CAMLC,yBAAyB,CAAE,oCAAM,CAC7B,GAAMR,MAAK,CAAGS,cAAc,CAACC,OAAf,CAAuB,OAAvB,CAAd,CACAC,OAAO,CAACC,GAAR,CAAY,yFAAZ,EACA,GAAIZ,KAAK,EAAIA,KAAK,EAAI,EAAlB,EAAwBA,KAAK,EAAI,WAArC,CAAkDF,QAAQ,CAAC,CAACE,KAAK,CAAEA,KAAR,CAAD,CAAR,CACrD,CAVI,CAYL;AAEAa,MAAM,CAAE,iBAAM,CACVJ,cAAc,CAACK,UAAf,CAA0B,OAA1B,EACAhB,QAAQ,CAAC,CAACE,KAAK,CAAE,IAAR,CAAD,CAAR,CACAW,OAAO,CAACC,GAAR,CAAY,kBAAZ,EACAG,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAuB,GAAvB,CACH,CAnBI,CAqBLC,KAAK,iFAAE,iBAAOC,KAAP,CAAcC,QAAd,uIACH;AACAT,OAAO,CAACC,GAAR,CAAY,sBAAZ,EACAD,OAAO,CAACC,GAAR,CAAYO,KAAZ,EACAR,OAAO,CAACC,GAAR,CAAYQ,QAAZ,EACA;AACMC,IANH,CAMU,CACTC,MAAM,CAAE,MADC,CAETC,OAAO,CAAE,CACL,eAAgB,kBADX,CAFA,CAKTC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,CACjBP,KAAK,CAAEA,KADU,CAEjBC,QAAQ,CAAEA,QAFO,CAAf,CALG,CANV,uCAkBoBO,MAAK,CAAC,QAAD,CAAWN,IAAX,CAlBzB,QAkBOO,IAlBP,oBAmBKA,IAAI,CAACC,MAAL,GAAgB,GAnBrB,2BAoBKC,KAAK,CAAC,qBAAD,CAAL,CApBL,gCAqBY,KArBZ,iCAwBoBF,KAAI,CAACG,IAAL,EAxBpB,SAwBOC,IAxBP,eAyBCrB,OAAO,CAACC,GAAR,CAAY,wBAAZ,CAAqCoB,IAArC,EACAvB,cAAc,CAACwB,OAAf,CAAuB,OAAvB,CAAgCD,IAAI,CAACE,YAArC,EACApC,QAAQ,CAAC,CAACE,KAAK,CAAEgC,IAAI,CAACE,YAAb,CAAD,CAAR,CA3BD,gCA4BQ,IA5BR,4DA+BCvB,OAAO,CAACwB,KAAR,CAAc,gCAAd,cA/BD,qEAAF,+EArBA,CAyDLC,YAAY,CAAE,uBAAM,CAChB,GAAMrC,MAAK,CAAGH,QAAQ,EAAtB,CACA,GAAMyB,KAAI,CAAG,CACTE,OAAO,CAAE,CACL,gBAAiB,UAAYxB,KAAK,CAACC,KAD9B,CADA,CAAb,CAKA;AACA2B,KAAK,CAAC,wBAAD,CAA2BN,IAA3B,CAAL,CACKgB,IADL,CACU,SAAAT,IAAI,QAAIA,KAAI,CAACG,IAAL,EAAJ,EADd,EAEKM,IAFL,CAEU,SAAAL,IAAI,QAAIlC,SAAQ,CAAC,CAACG,OAAO,CAAE+B,IAAI,CAAC/B,OAAf,CAAD,CAAZ,EAFd,EAGKqC,KAHL,CAGW,SAAAH,KAAK,QAAIxB,QAAO,CAACC,GAAR,CAAY,oBAAZ,CAAkCuB,KAAlC,CAAJ,EAHhB,EAIH,CArEI,CAsEL5B,WAAW,CAAE,qBAACgC,KAAD,CAAQC,KAAR,CAAkB,CAC3B;AACA,GAAMzC,MAAK,CAAGH,QAAQ,EAAtB,CAEA;AACA;AACA,GAAMM,KAAI,CAAGH,KAAK,CAACG,IAAN,CAAWuC,GAAX,CAAe,SAACC,GAAD,CAAMC,CAAN,CAAY,CACpC,GAAIA,CAAC,GAAKJ,KAAV,CAAiBG,GAAG,CAACE,UAAJ,CAAiBJ,KAAjB,CACjB,MAAOE,IAAP,CACH,CAHY,CAAb,CAMA;AACA5C,QAAQ,CAAC,CAAEI,IAAI,CAAEA,IAAR,CAAD,CAAR,CACH,CApFI,CAlBN,CAAP,CA4GH,CA9GD,CAiHA,cAAeP,SAAf"},"metadata":{},"sourceType":"module"}